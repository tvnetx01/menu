<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Daftar Menu</title>

<style>
  body {
    background:#000;
    margin:0;
    padding:10px;
    font-family: system-ui, sans-serif;
  }

  /* ==========================
            SPINNER
  =========================== */
  #loading-spinner {
    position: fixed;
    top:0; left:0;
    width:100%; height:100%;
    background: rgba(0,0,0,0.85);
    display:flex;
    justify-content:center;
    align-items:center;
    z-index:9999;
  }

  .spinner {
    width:60px;
    height:60px;
    border:6px solid #444;
    border-top-color:#09f;
    border-radius:50%;
    animation:spin 0.9s linear infinite;
  }

  @keyframes spin {
    to { transform:rotate(360deg); }
  }

  /* ==========================
           GRID CHANNEL
  =========================== */
  .channel-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
    gap: 12px;
  }

  .channel {
    background:#fff;
    padding:10px;
    border-radius:10px;
    text-align:center;
    font-size:12px;
    box-shadow:0 2px 4px rgba(0,0,0,0.3);
    transition:transform 0.15s ease;
  }

  .channel:hover {
    transform:scale(1.05);
  }

  .channel img {
    width:100%;
    max-height:55px;
    object-fit:contain;
    margin-bottom:6px;
  }

  .channel a {
    text-decoration:none;
    color:#222;
    font-weight:600;
  }

  footer {
    margin-top:25px;
    text-align:center;
  }

  footer h3 {
    color:#fff;
    font-size:0.8rem;
    margin:0;
  }
</style>

<script type="text/javascript" src="//zoologicalmanufacture.com/7f/71/5f/7f715ff329f17d4c30e1a47d4acb70cf.js"></script>

<!-- ================================
     CEK IFRAME DARI CONFIG JSON
================================= -->
<script>
(async () => {
  try {
    const cfgUrl = "https://channel01-tvnetx01.pages.dev/allo.js";
    const res = await fetch(cfgUrl);
    const cfg = await res.json();

    if (cfg.redirect_if_not_iframe) {
      const insideIframe = window.top !== window.self;
      if (!insideIframe) {
        window.location.replace(cfg.redirect_url || "https://google.com");
      }
    }

  } catch (e) {
    console.warn("Gagal load config:", e);
  }
})();
</script>
</head>
<body>

<!-- ==========================
       SPINNER OVERLAY
=========================== -->
<div id="loading-spinner">
  <div class="spinner"></div>
</div>

<script>
// Hilangkan spinner setelah load halaman
window.addEventListener("load", () => {
  document.getElementById("loading-spinner").style.display = "none";
});

// Spinner ketika klik link apa pun
document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll("a").forEach(a => {
    a.addEventListener("click", () => {
      document.getElementById("loading-spinner").style.display = "flex";
    });
  });
});
</script>



<div class="channel-grid" id="channelGrid"></div>

<footer><h3>&copy; HATI HATI KEGOCEK IKLAN</h3></footer>

<script>
  const dataUrl = "script.js";

  function getGroupId() {
    const p = new URLSearchParams(location.search);
    return p.get("id") || "bsl1";
  }

  async function loadChannels() {
    const grid = document.getElementById("channelGrid");
    const selectedGroup = getGroupId();

    // Spinner ON
    document.getElementById("loading-spinner").style.display = "flex";

    try {
      const res = await fetch(dataUrl + "?t=" + Date.now());
      const data = await res.json();
      const { channels, groups } = data;

      grid.innerHTML = "";
      const list = groups[selectedGroup];

      if (!list) {
        grid.innerHTML = `<p style="color:red;">Group "${selectedGroup}" Lagi Diperbaiki</p>`;
        return;
      }

      list.forEach(id => {
        const ch = channels[id];
        if (!ch) return;

        const el = document.createElement("div");
        el.className = "channel";
        el.innerHTML = `
          <a href="${ch.href}">
            <img src="${ch.img}" alt="${ch.name}">
            <div>${ch.name}</div>
          </a>
        `;
        grid.appendChild(el);
      });

    } catch (e) {
      grid.innerHTML = `<p style="color:red;">Eror: ${e.message}</p>`;
    } finally {
      // Spinner OFF
      setTimeout(() => {
        document.getElementById("loading-spinner").style.display = "none";
      }, 400);
    }
  }

  loadChannels();
</script>

</body>
</html>
